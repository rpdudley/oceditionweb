---
import Header from "@components/Header.astro";
import "@fontsource/be-vietnam-pro";
import "@fontsource-variable/gabarito";
import { SITE_CONFIG } from "@config";
import Footer from "@components/Footer.astro";
import Notes from "@components/Notes.astro";
import '@fontsource/fira-code';

const {
  title,
  description,
  siteLogo,
  navLinks,
  lang,
  author,
  socialLinks,
  socialImage,
  canonicalURL = new URL(Astro.url.pathname, Astro.site).href,
} = SITE_CONFIG;

const ogImgUrl = canonicalURL + socialImage;
---

<!doctype html>
<html lang={lang} class="scroll-pt-16 scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="author" content={author} />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>

    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:image" content={ogImgUrl} />

    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonicalURL} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={ogImgUrl} />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Alpine.js -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.10/dist/cdn.min.js" defer></script>
    
    <style>
      .page-transition {
        transition: transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
      }
      .slide-left {
        transform: translateX(-100%);
      }
      .notes-panel {
        transform: translateX(100%);
        transition: transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
      }
      .notes-panel.show {
        transform: translateX(0);
      }
    </style>

  </head>
  <body class="bg-black font-sans">
    <div x-data="{ showNotes: false }" @show-notes.window="showNotes = true" class="relative h-screen w-full">
      <!-- Main Content -->
      <div 
        class="page-transition absolute inset-0 bg-black"
        :class="{ 'slide-left': showNotes }"
      >
        <div class="h-full overflow-y-auto">
          <Header siteLogo={siteLogo} navLinks={navLinks} />
          <main class="mx-auto max-w-3xl px-5">
            <slot />
          </main>
          <Footer author={author} socialLinks={socialLinks} />
        </div>
      </div>

      <!-- Notes Section -->
      <div 
        class="notes-panel absolute inset-0 bg-black z-40"
        :class="{ 'show': showNotes }"
      >
        <div class="h-full overflow-y-auto">
          <!-- Notes Header with same styling as main header -->
          <header class="sticky top-0 z-50 mx-auto flex max-w-5xl animate-slide-in justify-between bg-black px-5 py-6">
            <div class="flex items-center gap-4">
              <button
                @click="showNotes = false"
                class="text-neutral hover:text-white transition-colors text-sm font-medium"
              >
                ‚Üê Back
              </button>
              <h1 class="text-white text-lg font-medium">Notes</h1>
            </div>
          </header>
          <!-- Remove the main wrapper to let Notes handle its own layout -->
          <Notes showNotes={true} />
        </div>
      </div>
    </div>
  </body>
</html>
